#chi-squared test for biol375L
#for F2 outcomes of a genetics cross
A<- 20
a<- 8
#degrees of freedom
df<- 1
#number sum of counts
n<- A + a
#expected counts in a 3:1 ratio
EA<- n*(3/4)
Ea<- n*(1/4)
#chi-square sum
S<- (EA - A)^2/EA + (Ea - a)^2/Ea
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
A<- 438
a<- 97
#degrees of freedom
df<- 1
#number sum of counts
n<- A + a
#expected counts in a 3:1 ratio
EA<- n*(3/4)
Ea<- n*(1/4)
#chi-square sum
S<- (EA - A)^2/EA + (Ea - a)^2/Ea
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
A<- 208
a<- 137
#degrees of freedom
df<- 1
#number sum of counts
n<- A + a
#expected counts in a 3:1 ratio
EA<- n*(9/16)
Ea<- n*(7/16)
#chi-square sum
S<- (EA - A)^2/EA + (Ea - a)^2/Ea
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#print the results into readable format
print(paste("The chi-square sum for an expected 3:1 ratio is" ,S31, "with a P-value of", P31, "."))
A<- 208
a<- 137
#degrees of freedom
df<- 1
#number sum of counts
n<- A + a
#expected counts in a 3:1 ratio
EA<- n*(9/16)
Ea<- n*(7/16)
#chi-square sum
S<- (EA - A)^2/EA + (Ea - a)^2/Ea
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#print the results into readable format
print(paste("The chi-square sum for an expected 3:1 ratio is" ,S31, "with a P-value of", P31, "."))
#print the results into readable format
print(paste("The chi-square sum for an expected 3:1 ratio is" ,S, "with a P-value of", P, "."))
A<- 20
a<- 10
#degrees of freedom
df<- 1
#number sum of counts
n<- A + a
#expected counts in a 3:1 ratio
EA<- n*(3/4)
Ea<- n*(1/4)
#chi-square sum
S<- (EA - A)^2/EA + (Ea - a)^2/Ea
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#print the results into readable format
print(paste("The chi-square sum for an expected 3:1 ratio is" ,S, "with a P-value of", P, "."))
EA97<- n*(9/16)
Ea97<- n*(7/16)
S97<- (EA97 - A)^2/EA97 + (Ea97 - a)^2/Ea97
P97<- pchisq(S97, df, lower.tail = FALSE)
print(paste("The chi-square sum for an expected 9:7 ratio is",S97,"with a P-value of", P97, "."))
barplot(c(A,a))
barplot(c(A,a), names=c("A","a"))
xlab="Phenotypes", ylab="Counts"
barplot(c(A,a), names=c("A","a")
xlab="Phenotypes", ylab="Counts")
barplot(c(A,a), names=c("A","a"),
xlab="Phenotypes", ylab="Counts")
barplot(c(A,a), names=c("A","a"),
xlab="Phenotypes", ylab="Counts",
col="magenta")
AB<- 587
Ab<- 231
aB<- 260
ab<- 86
n<- AB + Ab + aB + ab
AB<- 587
Ab<- 231
aB<- 260
ab<- 86
n2<- AB + Ab + aB + ab
S9331
EAB<- n*(9/16)
EAb<- n*(3/16)
EaB<- n*(3/16)
Eab<- n*(1/16)
S9331<- (EAB - AB)^2/EAB + (EAb - Ab)^2/EAb + (EaB - aB)^2/EaB + (Eab - ab)^2/Eab
df<- 3
S9331<- (EAB - AB)^2/EAB + (EAb - Ab)^2/EAb + (EaB - aB)^2/EaB + (Eab - ab)^2/Eab
P9331<- pchisq(S9331, df, lower.tail = FALSE)
##################### APE & R ################################# #####
install.packages('ape')
library(ape)
newicktree="((((((((((Great:0.06564290,Puffin:0.06172849):0.02177468,Kelp:0.06827192):0.03069859,(Pacific:0.05650900,Hummingbird:0.11165101):0.02087841):0.00645251,(Flamingo:0.06277688,(Laysan:0.07494325,(Emperor:0.04835265,Chinstrap:0.04728049):0.03236961):0.01285151):0.00756607):0.01254073,(Dodo:0.07932186,Pigeon:0.06562232):0.03303878):0.00856404,Pueo:0.10875665):0.00850504,(Kakapo:0.08632332,Rose-ringed:0.07019268):0.03891123):0.01232176,(Weka:0.10047277,(Chicken:0.09953061,(Mallard:0.07091105,Canadian:0.04485665):0.05226659):0.01602804):0.02196343):0.01224553,(Alala:0.08306726,(Myna:0.07109086,Iiwi:0.07464068):0.02446018):0.04231430):0.01435679,(Tinamou:0.13148591,(Ostrich:0.09707288,((Kiwi:0.07905502,Moa:0.07999222):0.02095941,(Elephant:0.07986634,Emu:0.07046134):0.01756011):0.02003584):0.02364554):0.02380526,American:0.20361373);"
birdtree<- read.tree(text=newicktext)
newicktext="((((((((((Great:0.06564290,Puffin:0.06172849):0.02177468,Kelp:0.06827192):0.03069859,(Pacific:0.05650900,Hummingbird:0.11165101):0.02087841):0.00645251,(Flamingo:0.06277688,(Laysan:0.07494325,(Emperor:0.04835265,Chinstrap:0.04728049):0.03236961):0.01285151):0.00756607):0.01254073,(Dodo:0.07932186,Pigeon:0.06562232):0.03303878):0.00856404,Pueo:0.10875665):0.00850504,(Kakapo:0.08632332,Rose-ringed:0.07019268):0.03891123):0.01232176,(Weka:0.10047277,(Chicken:0.09953061,(Mallard:0.07091105,Canadian:0.04485665):0.05226659):0.01602804):0.02196343):0.01224553,(Alala:0.08306726,(Myna:0.07109086,Iiwi:0.07464068):0.02446018):0.04231430):0.01435679,(Tinamou:0.13148591,(Ostrich:0.09707288,((Kiwi:0.07905502,Moa:0.07999222):0.02095941,(Elephant:0.07986634,Emu:0.07046134):0.01756011):0.02003584):0.02364554):0.02380526,American:0.20361373);"
birdtree<- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt<- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1= flightless 2= flight
trait<- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co<- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
#use model="ARD" for all rates different
ans<- ace(trait, dt, model= "ARD", type="d")
nodelabels(pie = ans$like.anc, piecol = co, cex = 0.75)
View(dt)
library(ape)
newicktext="((((((((((Great:0.06564290,Puffin:0.06172849):0.02177468,Kelp:0.06827192):0.03069859,(Pacific:0.05650900,Hummingbird:0.11165101):0.02087841):0.00645251,(Flamingo:0.06277688,(Laysan:0.07494325,(Emperor:0.04835265,Chinstrap:0.04728049):0.03236961):0.01285151):0.00756607):0.01254073,(Dodo:0.07932186,Pigeon:0.06562232):0.03303878):0.00856404,Pueo:0.10875665):0.00850504,(Kakapo:0.08632332,Rose-ringed:0.07019268):0.03891123):0.01232176,(Weka:0.10047277,(Chicken:0.09953061,(Mallard:0.07091105,Canadian:0.04485665):0.05226659):0.01602804):0.02196343):0.01224553,(Alala:0.08306726,(Myna:0.07109086,Iiwi:0.07464068):0.02446018):0.04231430):0.01435679,(Tinamou:0.13148591,(Ostrich:0.09707288,((Kiwi:0.07905502,Moa:0.07999222):0.02095941,(Elephant:0.07986634,Emu:0.07046134):0.01756011):0.02003584):0.02364554):0.02380526,American:0.20361373);"
birdtree<- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt<- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1= flightless 2= flight
trait<- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co<- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
#use model="ARD" for all rates different
ans<- ace(trait, dt, model= "ARD", type="d")
nodelabels(pie = ans$like.anc, piecol = co, cex = 0.75)
dt<- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1= flightless 2= flight
trait<- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co<- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
#use model="ARD" for all rates different
ans<- ace(trait, dt, model= "ARD", type="d")
nodelabels(pie = ans$like.anc, piecol = co, cex = 0.75)
View(dt)
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.5)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 1)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
nodelabels(cex=0.3)
nodelabels(0.3)
nodelabels()
nodelabels(cex=0.3)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels(cex=0.3)
tiplabels()
tiplabels(cex=0.3)
nodelabels(cex=0.3)
dt <- drop.tip(birdtree, 28)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels(cex=0.3)
tiplabels(cex=0.3)
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
co <- c("blue", "yellow")
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.5)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.5)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
quartz()
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
quartz()
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.5)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
quartz()
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.5)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
quartz()
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
tiplabels(bg = co[as.numeric(trait)])
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)])
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.5)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.3)
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.3)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
newicktext="((((((((('Great auk (Pinguinus impennis) L':0.06555015,'Puffin (Fratercula arctica) F':0.06140881):0.02220282,'Kelp gull (Larus dominicanus) F':0.06739857):0.03054857,('Pacific golden plover (Pluvialis fulva) F':0.05702070,'Hummingbird (Archilochus colubris) F':0.11032611):0.02049185):0.00688977,('Flamingo (Phoenicopterus ruber) F':0.06333116,('Laysan albatross (Phoebastria immutabilis) F':0.07566267,('Emperor penguin (Aptenodytes forsteri) L':0.04826935,'Chinstrap penguin (Pygoscelis antarcticus) L':0.04681582):0.03198343):0.01147368):0.00766409):0.01250018,('Pueo (Asio flammeus) F':0.10263153,('Dodo (Raphus cucullatus) L':0.07905966,'Pigeon (Columba livia) F':0.06494731):0.02717229):0.01392040):0.00967809,('Kakapo (Strigops habroptilus) L':0.08623496,'Rose-ringed parakeet (Psittacula krameri) F':0.06987947):0.04032532):0.01257381,('Weka (Gallirallus australis) L':0.09939147,('Chicken (Gallus gallus) F':0.09913348,('Mallard (Anas platyrhynchos) F':0.07019769,'Canadian goose (Branta canadensis) F':0.04503359):0.05222419):0.01653830):0.02247577):0.01161730,('Alala (Corvus hawaiiensis) F':0.08332863,('Myna (Sturnus tristis) F':0.07022060,'Iiwi (Drepanis coccinea) F':0.07493035):0.02410843):0.04128595):0.01426462,('Tinamou (Eudromia elegans) F':0.13149816,('Ostrich (Struthio camelus) L':0.09635161,(('Kiwi (Apteryx australis mantelli) L':0.07892020,'Moa (Dinornis giganteus) L':0.07965721):0.02102142,('Elephant bird (Mullerornis agilis) L':0.07960414,'Emu (Dromaius novaehollandiae) L':0.07026869):0.01746123):0.02008033):0.02326207):0.02327362,'American alligator (Alligator mississippiensis) O':0.20999408);"
birdtree <- read.tree(text=newicktext)
plot(birdtree)
nodelabels()
tiplabels()
dt <- drop.tip(birdtree, 28)
plot(dt)
nodelabels()
tiplabels()
# 1 = flightless, 2 = flight
trait <- c(1,2,2,2,2,2,2,1,1,2,1,2,1,2,1,2,2,2,2,2,2,2,1,1,1,1,1)
plot(dt)
co <- c("blue", "yellow")
tiplabels(bg = co[as.numeric(trait)], cex = 0.3)
# use model="ARD" for all rates different
ans <- ace(trait, dt, model="ARD", type = "d")
nodelabels(pie = ans$lik.anc, piecol = co, cex = 0.75)
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#chi-square sum
#S<- (EA - A)^2/EA + (Ea - a)^2/Ea
S<- 10.4323
#degrees of freedom
df<- 1
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#chi-square sum
#S<- (EA - A)^2/EA + (Ea - a)^2/Ea
S<- 12.4323
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#chi-square sum
#S<- (EA - A)^2/EA + (Ea - a)^2/Ea
S<- 10.4323
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
>print(pchisq(10.4323, df=1))
hi<- print(pchisq(10.4323, df=1))
hi<- print(pchisq(.0534, df=1))
hi<- print(pchisq(10.4323, df=1))
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#chi-square sum
#S<- (EA - A)^2/EA + (Ea - a)^2/Ea
S<- 2.78
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
#chi-square sum
#S<- (EA - A)^2/EA + (Ea - a)^2/Ea
S<- 18.255
#use a built in fuction pchisq() to get the p-value
P<- pchisq(S, df, lower.tail = FALSE)
library(tidyverse)
getwd()
setwd("/Users/ninahmunk/Documents/Projects/Regeneration_3/PAM/data")
setwd("/Users/ninahmunk/Documents/Projects/Regeneration_3/PAM/data")
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")
library(readxl)
library(janitor)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")
View(initial)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")%>%
select(c())
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")
setwd("/Users/ninahmunk/Documents/Projects/Regeneration_3/PAM/data")
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")
View(initial)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601") head(initial)
head(initial)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")%>%clean_names()
head(initial)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")%>%clean_names()%>%
select(c(date,genotype, id, f0,fm,fv_fm))
head(initial)
aggregate(.~id,data=initial,mean)
initial_mean<-aggregate(.~id,data=initial,mean)
View(initial_mean)
day10<- read_xlsx("day10_PAM.xlsx", sheet= "20230622")%>%clean_names()
day10<- read_xlsx("day10_PAM.xlsx", sheet= "20230622")%>%clean_names()%>%
select(c(date, id, f0,fm,fv_fm))
head(day10)
day10<- read_xlsx("day10_PAM.xlsx", sheet= "20230622")%>%clean_names()%>%
select(c(date, id, f0,fm,fv_fm))
head(day10)
day10<- read_xlsx("day10_PAM.xlsx", sheet= "20230622")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
head(day10)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")%>%clean_names()%>%
select(c(date,genotype, id, f0,fm,fv_fm))%>%
rename("id" = "coral_id")
head(initial)
initial<- read_xlsx("20230601_initial.xlsx", sheet= "20230601")%>%clean_names()%>%
select(c(date,genotype, id, f0,fm,fv_fm))%>%
rename("coral_id" = "id")
head(initial)
#use aggregate function to find the mean of values in other column(s) (f0, fm, fv/fm) based on factor levels in coral_id column
initial_mean<-aggregate(.~coral_id,data=initial,mean)
View(initial_mean)
day10_mean<-aggregate(.~coral_id,data=day10,mean)
View(day10_mean)
day10_g1<- read_xlsx("day10_PAM.xlsx", sheet= "20230622")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
head(day10_g1)
day10_g2<- read_xlsx("day10_PAM.xlsx", sheet= "20230623")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
head(day10_g2)
day10_g3<- read_xlsx("day10_PAM.xlsx", sheet= "20230624")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
day10_g3<- read_xlsx("day10_PAM.xlsx", sheet= "20230624")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
head(day10_g3)
#Fills missing values in selected columns using the next or previous entry. This is useful in the common output format where values are not repeated, and are only recorded when they change
fill(day10_g3, .direction = c("up"))
day10_g3<- read_xlsx("day10_PAM.xlsx", sheet= "20230624")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))
head(day10_g3)
day10_g3<- read_xlsx("day10_PAM.xlsx", sheet= "20230624")%>%clean_names()%>%
select(c(date, coral_id, f0,fm,fv_fm))%>%
fill(coral_id)
head(day10_g3)
day10_merge <- merge(day10_g1, day10_g2, day10_g3,
by = 'row.names', all = TRUE)
day10_bind <- bind_rows(day10_g1, day10_g2, day10_g3)
View(day10_bind)
day10_mean<-aggregate(.~coral_id,data=day10_bind,mean)
View(day10_mean)
